<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI旅行规划器</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- 导航栏 -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <i class="fas fa-plane"></i>
                    <span>AI旅行规划器</span>
                </div>
                <div class="nav-menu" id="navMenu">
                    <a href="#home" class="nav-link active">首页</a>
                    <a href="#plans" class="nav-link">我的行程</a>
                    <a href="#map" class="nav-link">地图导航</a>
                    <a href="#expenses" class="nav-link">费用管理</a>
                    <a href="#profile" class="nav-link">个人中心</a>
                    <a href="#settings" class="nav-link" style="display: none;" id="settingsNavLink">设置</a>
                </div>
                <div class="nav-auth">
                    <button id="loginBtn" class="btn btn-outline">登录</button>
                    <button id="registerBtn" class="btn btn-primary">注册</button>
                    <div id="userMenu" class="user-menu" style="display: none;">
                        <span id="userName"></span>
                        <button id="logoutBtn" class="btn btn-outline">退出</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- 主要内容区域 -->
        <main class="main-content">
            <!-- 首页 -->
            <section id="home" class="page active">
                <div class="hero">
                    <h1>智能旅行规划</h1>
                    <p>通过AI技术，为您量身定制完美的旅行体验</p>
                    <div class="hero-features">
                        <div class="feature">
                            <i class="fas fa-microphone"></i>
                            <h3>语音输入</h3>
                            <p>支持语音描述旅行需求</p>
                        </div>
                        <div class="feature">
                            <i class="fas fa-robot"></i>
                            <h3>AI规划</h3>
                            <p>智能生成个性化行程</p>
                        </div>
                        <div class="feature">
                            <i class="fas fa-calculator"></i>
                            <h3>预算管理</h3>
                            <p>智能费用分析和控制</p>
                        </div>
                    </div>
                </div>

                <!-- 快速创建行程 -->
                <div class="quick-create">
                    <h2>快速创建行程</h2>
                    <div class="create-form">
                        <div class="input-group">
                            <label>目的地 <span class="required">*</span></label>
                            <input type="text" id="destination" placeholder="请输入目的地，如：日本东京" required>
                        </div>
                        <div class="input-group">
                            <label>出发日期 <span class="required">*</span></label>
                            <input type="date" id="startDate" required>
                        </div>
                        <div class="input-group">
                            <label>返回日期 <span class="required">*</span></label>
                            <input type="date" id="endDate" required>
                        </div>
                        <div class="input-group">
                            <label>预算（元） <span class="required">*</span></label>
                            <input type="number" id="budget" placeholder="10000" min="0" step="0.01" required>
                        </div>
                        <div class="input-group">
                            <label>人数 <span class="required">*</span></label>
                            <input type="number" id="people" placeholder="2" min="1" required>
                        </div>
                        <div class="input-group">
                            <label>偏好</label>
                            <textarea id="preferences" placeholder="请描述您的旅行偏好，如：喜欢美食、动漫、购物等"></textarea>
                        </div>
                        <button id="createPlanBtn" class="btn btn-primary btn-large">
                            <i class="fas fa-magic"></i>
                            生成AI行程
                        </button>
                    </div>
                </div>

                <!-- 语音输入区域 -->
                <div class="voice-input">
                    <h2>语音输入</h2>
                    <div class="voice-controls">
                        <button id="voiceBtn" class="btn btn-voice">
                            <i class="fas fa-microphone"></i>
                            点击说话
                        </button>
                        <div id="voiceStatus" class="voice-status"></div>
                    </div>
                    <div id="voiceResult" class="voice-result"></div>
                </div>
            </section>

            <!-- 我的行程 -->
            <section id="plans" class="page">
                <div class="page-header">
                    <h2>我的行程</h2>
                    <button id="newPlanBtn" class="btn btn-primary">
                        <i class="fas fa-plus"></i>
                        新建行程
                    </button>
                </div>
                <div id="plansList" class="plans-list">
                    <!-- 行程列表将在这里动态生成 -->
                </div>
            </section>

            <!-- 地图导航 -->
            <section id="map" class="page">
                <div class="page-header">
                    <h2>地图导航</h2>
                </div>
                <div class="map-container">
                    <div class="map-controls">
                        <div class="input-group">
                            <label>起点</label>
                            <input type="text" id="mapOrigin" placeholder="请输入起点地址或点击地图选择">
                            <button id="mapOriginGeocode" class="btn btn-small btn-outline">搜索</button>
                        </div>
                        <div class="input-group">
                            <label>终点</label>
                            <input type="text" id="mapDestination" placeholder="请输入终点地址或点击地图选择">
                            <button id="mapDestinationGeocode" class="btn btn-small btn-outline">搜索</button>
                        </div>
                        <div class="input-group">
                            <label>搜索地点</label>
                            <input type="text" id="mapSearchKeyword" placeholder="搜索地点、餐厅、酒店等">
                            <button id="mapSearchBtn" class="btn btn-small btn-primary">搜索</button>
                        </div>
                        <div class="map-route-controls">
                            <label>导航方式：</label>
                            <button class="btn btn-small btn-outline active" data-mode="driving">
                                <i class="fas fa-car"></i> 驾车
                            </button>
                            <button class="btn btn-small btn-outline" data-mode="walking">
                                <i class="fas fa-walking"></i> 步行
                            </button>
                            <button class="btn btn-small btn-outline" data-mode="transit">
                                <i class="fas fa-bus"></i> 公交
                            </button>
                            <button id="mapRouteBtn" class="btn btn-small btn-primary">
                                <i class="fas fa-route"></i> 规划路线
                            </button>
                            <button id="mapClearBtn" class="btn btn-small btn-outline">
                                <i class="fas fa-eraser"></i> 清除
                            </button>
                        </div>
                    </div>
                    <div id="mapContainer" class="map-view">
                        <div id="mapLoading" class="map-loading">
                            <div class="loading-spinner"></div>
                            <p>正在加载地图...</p>
                        </div>
                        <div id="mapError" class="map-error" style="display: none;">
                            <p>地图加载失败</p>
                            <p class="map-error-hint">请检查API Key配置或网络连接</p>
                        </div>
                    </div>
                    <div id="mapInfo" class="map-info">
                        <div id="mapRouteInfo" class="route-info" style="display: none;">
                            <h4>路线信息</h4>
                            <div id="mapRouteDetails"></div>
                        </div>
                        <div id="mapPOIList" class="poi-list"></div>
                    </div>
                </div>
            </section>

            <!-- 费用管理 -->
            <section id="expenses" class="page">
                <div class="page-header">
                    <h2>费用管理</h2>
                    <button id="addExpenseBtn" class="btn btn-primary">
                        <i class="fas fa-plus"></i>
                        添加费用
                    </button>
                    <button id="expenseVoiceBtn" class="btn btn-outline">
                        <i class="fas fa-microphone"></i>
                        语音记账
                    </button>
                </div>
                <div class="input-group" style="max-width:420px;margin-bottom:1rem;">
                    <label>选择行程</label>
                    <select id="expensePlanSelect"></select>
                </div>
                <div class="expense-summary">
                    <div class="summary-card">
                        <h3>总支出</h3>
                        <span id="totalExpense" class="amount">¥0</span>
                    </div>
                    <div class="summary-card">
                        <h3>预算</h3>
                        <span id="budgetAmount" class="amount">¥0</span>
                    </div>
                    <div class="summary-card">
                        <h3>剩余</h3>
                        <span id="remainingAmount" class="amount">¥0</span>
                    </div>
                </div>
                <div id="expensesList" class="expenses-list">
                    <!-- 费用列表将在这里动态生成 -->
                </div>
            </section>

            <!-- 个人中心 -->
            <section id="profile" class="page">
                <div class="page-header">
                    <h2>个人中心</h2>
                </div>
                <div class="profile-content">
                    <div class="profile-tabs">
                        <button class="tab-btn active" data-tab="info">个人信息</button>
                        <button class="tab-btn" data-tab="settings">设置</button>
                    </div>
                    
                    <!-- 个人信息标签页 -->
                    <div id="profileInfoTab" class="profile-tab-content active">
                        <div class="profile-info">
                            <div class="avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="user-info">
                                <h3 id="profileName">用户名</h3>
                                <p id="profileEmail">user@example.com</p>
                            </div>
                        </div>
                        <div class="profile-actions">
                            <button class="btn btn-outline">编辑资料</button>
                            <button class="btn btn-outline">修改密码</button>
                        </div>
                    </div>
                    
                    <!-- 设置标签页 -->
                    <div id="profileSettingsTab" class="profile-tab-content">
                        <div class="settings-section">
                            <h3><i class="fas fa-key"></i> API配置</h3>
                            <p class="settings-description">配置您的OpenAI API密钥以使用AI行程规划功能</p>
                            
                            <div class="input-group">
                                <label for="openaiApiKey">OpenAI API Key <span class="required">*</span></label>
                                <input type="password" id="openaiApiKey" placeholder="sk-..." class="api-key-input">
                                <small class="input-hint">
                                    <i class="fas fa-info-circle"></i>
                                    您的API密钥将安全存储在本地，仅用于生成旅行计划
                                </small>
                            </div>
                            
                            <div class="input-group">
                                <label for="openaiBaseUrl">OpenAI Base URL（可选）</label>
                                <input type="text" id="openaiBaseUrl" placeholder="https://api.openai.com/v1" value="https://api.openai.com/v1">
                                <small class="input-hint">
                                    默认使用官方API，如需使用代理或其他兼容服务可修改此地址
                                </small>
                            </div>

                            <div class="input-group">
                                <label for="openaiModel">模型（可选）</label>
                                <input type="text" id="openaiModel" placeholder="gpt-4o-mini 或 deepseek-chat">
                                <small class="input-hint">
                                    若使用 DeepSeek，请设置 Base URL 为 https://api.deepseek.com/v1 且模型为 deepseek-chat
                                </small>
                            </div>
                            
                            <div class="settings-actions">
                                <button id="saveSettingsBtn" class="btn btn-primary">
                                    <i class="fas fa-save"></i>
                                    保存设置
                                </button>
                                <button id="testApiKeyBtn" class="btn btn-outline">
                                    <i class="fas fa-vial"></i>
                                    测试连接
                                </button>
                            </div>
                            
                            <div id="apiKeyStatus" class="api-key-status"></div>
                        </div>

                        <div class="settings-section" style="margin-top: 2rem;">
                            <h3><i class="fas fa-map-marked-alt"></i> 高德地图API配置</h3>
                            <p class="settings-description">配置您的高德地图API密钥以使用地图导航功能</p>
                            
                            <div class="input-group">
                                <label for="amapApiKey">高德地图API Key <span class="required">*</span></label>
                                <input type="password" id="amapApiKey" placeholder="请输入高德地图API Key" class="api-key-input">
                                <small class="input-hint">
                                    <i class="fas fa-info-circle"></i>
                                    获取方式：访问 <a href="https://console.amap.com/dev/key/app" target="_blank">高德开放平台</a> 创建应用，选择"Web端(JS API)"类型获取Key用于地图显示，或选择"Web服务"类型获取Key用于后端调用。建议同时创建两种类型的Key。
                                </small>
                            </div>
                            
                            <div class="settings-actions">
                                <button id="saveAmapSettingsBtn" class="btn btn-primary">
                                    <i class="fas fa-save"></i>
                                    保存地图设置
                                </button>
                                <button id="testAmapApiKeyBtn" class="btn btn-outline">
                                    <i class="fas fa-vial"></i>
                                    测试地图Key
                                </button>
                            </div>
                            
                            <div id="amapApiKeyStatus" class="api-key-status"></div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- 模态框 -->
        <div id="modal" class="modal">
            <div class="modal-content" id="modalContent">
                <span class="close">&times;</span>
                <div id="modalBody" class="modal-body-content"></div>
            </div>
        </div>

        <!-- 登录/注册模态框 -->
        <div id="authModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div class="auth-tabs">
                    <button class="tab-btn active" data-tab="login">登录</button>
                    <button class="tab-btn" data-tab="register">注册</button>
                </div>
                <div id="loginForm" class="auth-form active">
                    <h3>登录</h3>
                    <form>
                        <div class="input-group">
                            <label>邮箱</label>
                            <input type="email" id="loginEmail" required>
                        </div>
                        <div class="input-group">
                            <label>密码</label>
                            <input type="password" id="loginPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">登录</button>
                    </form>
                </div>
                <div id="registerForm" class="auth-form">
                    <h3>注册</h3>
                    <form>
                        <div class="input-group">
                            <label>邮箱</label>
                            <input type="email" id="registerEmail" required>
                        </div>
                        <div class="input-group">
                            <label>用户名</label>
                            <input type="text" id="registerUsername" required>
                        </div>
                        <div class="input-group">
                            <label>密码</label>
                            <input type="password" id="registerPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">注册</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>


